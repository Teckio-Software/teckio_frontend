<section class="m-1">
  <div class="flex">
    <button
      (click)="abrirDialogoFormularioGuardar()"
      class="flex align-items-center rounded-md bg-colorButton transition-colors delay-75 hover:bg-colorButtonHover font-light text-white p-1"
    >
      <p
        class="text-[#f2f2f2] titular bg-custom-bg w-52 font-medium text-base tracking-wider m-0 text-center xs:text-[10px] xs:w-24"
      >
        Agregar contratista
      </p>
      <img src="assets/add.svg" alt="" />
    </button>
  </div>
  <p class="text-sm font-medium mb-2 mt-2 text-gray700 xs:text-[10px]">
    Selecciona el contratista para ver sus cuentas bancarias y cuentas
    contables.
  </p>
  <div class="overflow-x-auto shadow-md rounded-lg">
    <table class="w-full text-sm xs:table-fixed">
      <thead class="bg-primario text-white">
        <tr>
          <th class="px-1 py-[2px]" class="px-1 py-[2px] xs:w-[75px]">
            Razon Social
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            RFC
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            Representante legal
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            Telefono
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            Email
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            Domicilio
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            No. Exterior
          </th>
          <th class="px-1 py-[2px]" class="px-[2px] py-[2px] xs:w-[70px]">
            Tipo
          </th>
          <th
            class="px-1 py-[2px]"
            class="px-[2px] py-[2px] xs:w-[70px] text-center"
          >
            Acciones
          </th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray300">
        <ng-container *ngIf="isLoading">
          <tr>
            <!-- Razón Social -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- RFC -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Representante legal -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Teléfono -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-32 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Email -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-40 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Domicilio -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- No. Exterior -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-24 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Tipo -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Acciones -->
            <td scope="col">
              <div
                role="status"
                class="flex justify-center align-items-centermax-w-sm animate-pulse"
              >
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
          </tr>
          <tr>
            <!-- Razón Social -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- RFC -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Representante legal -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Teléfono -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-32 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Email -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-40 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Domicilio -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- No. Exterior -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-24 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Tipo -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Acciones -->
            <td scope="col">
              <div
                role="status"
                class="flex justify-center align-items-centermax-w-sm animate-pulse"
              >
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
          </tr>
          <tr>
            <!-- Razón Social -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- RFC -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Representante legal -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-48 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Teléfono -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-32 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Email -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-40 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Domicilio -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- No. Exterior -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-24 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Tipo -->
            <td class="px-1" scope="col">
              <div role="status" class="max-w-sm animate-pulse">
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
            <!-- Acciones -->
            <td scope="col">
              <div
                role="status"
                class="flex justify-center align-items-centermax-w-sm animate-pulse"
              >
                <div
                  class="h-5 bg-gray300 rounded-full w-28 xs:w-14 xs:h-3 mt-1 mb-1"
                ></div>
              </div>
            </td>
          </tr>
        </ng-container>
        <tr *ngIf="paginatedContratista.length == 0 && !isLoading">
          <td colspan="6" class="text-center text-gray-700 font-medium py-1">
            No hay requisiciones creadas.
          </td>
        </tr>
        <tr
          *ngFor="let contratista of paginatedContratista"
          [ngClass]="{
            'change-background-color': contratista.id == changeColor
          }"
          class="font-medium text-gray700 hover:bg-gray200 animation duration-200 xs:text-[8px]"
        >
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{ contratista.razonSocial }}
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{ contratista.rfc }}
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{ contratista.representanteLegal }}
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{ contratista.telefono }}
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{ contratista.email }}
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            <input
              type="text"
              class="bg-transparent w-full"
              [(ngModel)]="contratista.domicilio"
              disabled
            />
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{ contratista.nExterior }}
          </td>
          <td
            class="px-1 py-[2px]"
            (click)="SeleccionaContratista(contratista.id)"
          >
            {{
              contratista.esProveedorMaterial && contratista.esProveedorServicio
                ? "Subcontratista"
                : contratista.esProveedorMaterial
                ? "Proveedor"
                : "Contratista"
            }}
          </td>
          <td class="px-1 py-[2px]">
            <div class="flex flex-wrap justify-center gap-2">
              <button
                (click)="abrirModalCBContratista(contratista.id)"
                ngbTooltip="Nueva Cuenta Bancaria"
                placement="top"
                triggers="mouseenter:mouseleave"
                class="bg-[#51aec7] hover:bg-hoverButton transition-colors duration-200 w-5 h-5 flex items-center justify-center rounded-md"
              >
                <img
                  src="assets/card.svg"
                  alt="Nueva Cuenta Bancaria"
                  class="w-4 h-4"
                />
              </button>

              <button
                (click)="abrirDialogoFormulario(contratista)"
                ngbTooltip="Editar"
                placement="top"
                triggers="mouseenter:mouseleave"
                class="bg-[#51aec7] hover:bg-hoverButton transition-colors duration-200 w-5 h-5 flex items-center justify-center rounded-md"
              >
                <svg
                  fill="#f2f2f2"
                  viewBox="-4 0 32 32"
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-4 h-4"
                >
                  <path
                    d="M17.438 22.469v-4.031l2.5-2.5v7.344c0 1.469-1.219 2.688-2.656 2.688h-14.625c-1.469 0-2.656-1.219-2.656-2.688v-14.594c0-1.469 1.188-2.688 2.656-2.688h14.844v0.031l-2.5 2.469h-11.5c-0.531 0-1 0.469-1 1.031v12.938c0 0.563 0.469 1 1 1h12.938c0.531 0 1-0.438 1-1zM19.813 7.219l2.656 2.656 1.219-1.219-2.656-2.656zM10.469 16.594l2.625 2.656 8.469-8.469-2.625-2.656zM8.594 21.094l3.625-0.969-2.656-2.656z"
                  />
                </svg>
              </button>

              <button
                (click)="abrirDialogo(contratista.id)"
                ngbTooltip="Eliminar"
                placement="top"
                triggers="mouseenter:mouseleave"
                class="bg-[#51aec7] hover:bg-hoverButton transition-colors duration-200 w-5 h-5 flex items-center justify-center rounded-md"
              >
                <img src="assets/borrar.svg" alt="Eliminar" class="w-4 h-4" />
              </button>

              <button
                (click)="abrirModalCCContratista(contratista)"
                ngbTooltip="Asignar Cuenta Contable"
                placement="left"
                triggers="mouseenter:mouseleave"
                class="bg-[#51aec7] hover:bg-hoverButton transition-colors duration-200 w-5 h-5 flex items-center justify-center rounded-md"
              >
                <img
                  src="assets/cuenta_contable.svg"
                  alt="Asignar Cuenta Contable"
                  class="w-4 h-4"
                />
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="flex bg-[#ffffff] justify-end rounded-b-[3px]">
      <div class="flex items-center">
        {{ getPaginationInfo() }}
      </div>
      <nav class="p-2">
        <ul class="flex">
          <li class="flex items-center">
            <a
              class="mx-1 flex h-7 w-7 items-center justify-center rounded-full border border-blue-gray-100 bg-transparent p-0 text-sm text-blue-gray-500 transition duration-150 ease-in-out hover:bg-[#2d748d] cursor-pointer"
              (click)="previousPage()"
              aria-label="Previous"
            >
              <span class="material-icons text-sm">keyboard_arrow_left</span>
            </a>
          </li>
          <li *ngFor="let page of visiblePages" class="flex items-center">
            <a
              class="mx-1 flex h-7 w-7 items-center justify-center rounded-full hover:bg-[#2d748d] cursor-pointer"
              [ngClass]="{
                'bg-colorButton text-[#ffffff] shadow-md': currentPage === page,
                'border border-blue-gray-100 bg-transparent text-blue-gray-500 hover:bg-[#2d748d]':
                  currentPage !== page
              }"
              [class.active]="page === currentPage"
              (click)="goToPage(page)"
            >
              {{ page }}
            </a>
          </li>
          <li class="flex items-center">
            <a
              class="mx-1 flex h-7 w-7 items-center justify-center rounded-full border border-blue-gray-100 bg-transparent p-0 text-sm text-blue-gray-500 transition duration-150 ease-in-out hover:bg-light-300 cursor-pointer"
              (click)="nextPage()"
              aria-label="Next"
            >
              <span class="material-icons text-sm">keyboard_arrow_right</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</section>
<section class="m-2" *ngIf="contratistaSeleccionado">
  <!-- <app-table-contratistas [contratistas]="contratistas"></app-table-contratistas> -->

  <mat-tab-group
    class="first-custom-tab-group"
    animationDuration="0ms"
    (selectedTabChange)="yourFn($event)"
    [selectedIndex]="selectedIndex"
  >
    <mat-tab label="Cuentas Bancarias">
      <div>
        <app-cuentas-bancarias-contratista
          *appRecarga="appRefrescar"
          [IdContratistaInput]="idContratista"
          [IdEmpresaInput]="selectedEmpresa"
        ></app-cuentas-bancarias-contratista>
      </div>
    </mat-tab>
    <mat-tab label="Cuentas contables">
      <div *ngIf="selectedIndex === 1">
        <app-table-cuentas-contables
          *appRecarga="appRefrescar"
          [IdContratistaInput]="idContratista"
        ></app-table-cuentas-contables>
      </div>
    </mat-tab>
  </mat-tab-group>
</section>
