



<!---------------------------------------------contenido-filtro---------------------------------------------------->
<div style="margin: 20px 40px 40px 40px">
  <div style="display: flex; justify-content: space-between; align-items: center" class="cont-filter">
    <div class="cont-filtro">
      <div class="cont-filtro">
        <div class="form-group">
          <label class="label-calendar" for="fechaInicio" style="font-weight: bold;">
            Inicio
            <svg style="margin-left: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
              fill="currentColor" class="bi bi-calendar" viewBox="0 0 16 16">
              <path
                d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
            </svg>
          </label>
          <input class="input-calendar" type="text"  id="fechaInicio" data-provide="datepicker"
            data-date-format="dd/mm/yyyy" placeholder="dd/mm/yyyy">
        </div>

        <div class="form-group" style="margin-right: 16px;">
          <label class="label-calendar" for="fechaFin" style="font-weight: bold;">
            Final
            <svg style="margin-left: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
              fill="currentColor" class="bi bi-calendar" viewBox="0 0 16 16">
              <path
                d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
            </svg>
          </label>
          <input class="input-calendar" style="text-align: center; background-color: #f2f2f2;" type="text" id="fechaFin" data-provide="datepicker"
            data-date-format="dd/mm/yyyy" placeholder="dd/mm/yyyy">
        </div>
      </div>
    </div>
    <button type="button" class="button-filt button-simulacion" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
      Simulación
    </button>
    <div class="asignar">
      <form>
        <input class="search" style="text-align: center;" #input placeholder="orden de compra" />
      </form>
      <form>
        <input class="search" style="text-align: center;" #div placeholder="División"/>
      </form>
      <button class="button-2" (click)="obtenerOrdenCompra(input.value,div.value)">
        Buscar
      </button>
    </div>
  </div>
<br>

  <!------------------------------------------------------------------------------------Aquí acaba el filtro---------------------------------------------------------------------------------------->

  <!-------------------------------------------------------------------------------------------------Nueva tabla-------------------------------------------------------------------------------------->

  <button class="ocultar" (click)="ocultarTablas()" *ngIf="iconRegresar">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
    </svg>
  </button>

  <!-------------------------Tabla orden de compra------------------------------->
  <div class="cont-table orden-compra" *ngIf="ocultarTabla1">
    <div  style="width: 100%;">
      <table class="table table-striped rounded table-hover table-scrool-x">
        <thead>
          <tr>
            <th class="cabecera tabla377" scope="col">Orden de compra</th>
            <th class="cabecera " scope="col" style="width: 40%;">Proveedor</th>
            <th class="cabecera tabla377" scope="col">Fecha</th>
            <th class="cabecera" scope="col">Estatus</th>
            <th class="cabecera end-text" scope="col">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let orden of ordenCompraWs" (click)="toggleContenido(orden)"  >
            <td class="none tabla377">{{ orden.numeroOrdenCompra}}</td>
            <td class="none tabla377">{{ orden.proveedor }}</td>
            <td class="none tabla377">{{ orden.fecha | date:'dd-MM-yyyy' }}</td>
            <td class="none">
              {{ orden.estatusAlmacen == 1 ? 'No entregado' : '' }}
              {{ orden.estatusAlmacen == 2 ? 'Parcialmente entregado' : ''}}
              {{ orden.estatusAlmacen == 3 ? orden.estatusOrdenCompraWS == 'F' ? 'Facturado' : 'Entregado' : ''}}
              {{ orden.estatusAlmacen == 3 ? orden.estatusOrdenCompraWS == 'R' ? 'Facturado parcialmente' : 'Entregado' : ''}}
            </td>
            <td class="none end-text" style="text-align: end;"> {{ orden.total  }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="card-info-o" *ngIf="mostrarTabla2">
    <table>
      <tbody>
        <tr style="display: flex; align-items: center;" >
          <td class="info-card" style="color: #020202; font-size: 14px; font-weight: 600;" > No. Orden de compra: {{ ' ' + selectedOrdenCompraWs.numeroOrdenCompra}}</td>
          <td class="info-card" style="color: #020202; font-size: 14px; font-weight: 600;" > Proveedor: {{' ' + selectedOrdenCompraWs.proveedor }}</td>
          <td class="info-card" style="color: #020202; font-size: 14px; font-weight: 600;" > Total: {{' ' + selectedOrdenCompraWs.total }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-------------------------Tabla detalle orden de compra------------------------->
  <div class="cont-table orden-compra tabla2" *ngIf="mostrarTabla2" id="tabla-detalle" class="cont-table tabla-detalle">
    <table [class.ocultar-contenido]="!mostrarContenido" class="table table-striped rounded table-hover">
      <thead>
        <tr >
          <th class="cabecera tabla377" scope="col">No. Línea</th>
          <th class="cabecera" style="width: 40%;" scope="col">Descripción</th>
          <th class="cabecera tabla377 end-text" scope="col">Cantidad</th>
          <th class="cabecera" scope="col">Unidad</th>
          <th class="cabecera end-text" scope="col">Precio</th>
          <th class="cabecera end-text" scope="col">Importe</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let orden of detalleOrdenPorConfirmar">
          <ng-container>
            <td (click)="obtenerOrdenCompragGeneral(orden);" class="none tabla377">{{ orden.noLinea }}</td>
            <td class="none tabla377"> {{ orden.descripcion }}</td>
            <td class="none tabla377 end-text"> {{ orden.cantidad }} </td>
            <td class="none"> {{orden.unidad}} </td>
            <td class="none end-text"> {{ orden.costoUnitario }} </td>
            <td class="none end-text"> {{ orden.costoTotal }} </td>
          </ng-container>
        </tr>
      </tbody>
    </table>
  </div>

  <div style="display: flex; justify-content: start;" *ngIf="pestanas">
    <button class="button-entradas1" (click)="mostrarEntradas()">
      Entradas
    </button>
    <button  class="button-entradas1" (click)="toggleTabla4();">
      Entradas por Línea
    </button>
    <button class="button-entradas1" (click)="mostrarMontos()">
      Montos
    </button>
    <button class="button-entradas1" (click)="mostrarProveedores()">
      Proveedor
    </button>
    <button class="button-entradas1" (click)="mostrarComprador()">
      Comprador
    </button>
    <button class="button-entradas1" (click)="mostrarEntrega()">
      Entrega
    </button>
  </div>

  <div *ngIf="mostrarTabla3" class="contenedor-entradas">

    <!-------------------------Tabla detalle entradas-------------------------->
    <table  class="table table-striped rounded table-hover" >
      <thead>
        <tr>
          <th class="cabecera tabla377" scope="col">No Entrada</th>
          <th class="cabecera tabla377" scope="col">Fecha</th>
          <th class="cabecera tabla377" scope="col">Referencia</th>
          <th class="cabecera" scope="col">Moneda</th>
          <th class="cabecera end-text" scope="col">Total</th>
          <th class="cabecera" scope="col">Estatus Factura</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let orden of entradasLinea">
        <ng-container >
          <td class="none tabla377" (click)="toggleTabla5(orden);"> {{ orden.noEntrada.slice(0,-4) }} </td>
          <td class="none tabla377"> {{ orden.fecha | date:'dd-MM-yyyy' }} </td>
          <td class="none tabla377"> {{ orden.referencia }} </td>
          <td class="none"> {{ orden.moneda }} </td>
          <td class="none end-text"> {{ orden.total | currency:'$' }} </td>
          <td class="none">
            <div class="cloud-factura">
              <button  type="button" class="buton-cloud-factura" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" (click)="functionSeleccionarNoEntrada(orden)">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cloud-arrow-up-fill" viewBox="0 0 16 16" data-bs-target="#staticBackdrop1">
                  <path d="M8 2a5.53 5.53 0 0 0-3.594 1.342c-.766.66-1.321 1.52-1.464 2.383C1.266 6.095 0 7.555 0 9.318 0 11.366 1.708 13 3.781 13h8.906C14.502 13 16 11.57 16 9.773c0-1.636-1.242-2.969-2.834-3.194C12.923 3.999 10.69 2 8 2m2.354 5.146a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0z"/>
                </svg>
              </button>
            </div>
            <div *ngIf="orden.estatus == '2'"><p>Facturada</p></div>
          </td>
        </ng-container>
        </tr>
      </tbody>
      <tbody>

      <tr>
        <ng-container >
          <td class="none totalNone" >  </td>
          <td class="none totalNone" >  </td>
          <td class="none totalNone" >  </td>
          <td class="none totalNone" >  </td>
          <td class="none total" style="color: #f2f2f2; text-align: end;"> Total: {{ sumaTotal }}</td>
          <td class="none totalNone" >  </td>
        </ng-container>
      </tr>
      </tbody>
    </table>
  </div>

<!-------------------------------------Contenedor entradas por línea-------------------------------------->
  <div class="contenedor-entradas" *ngIf="mostrarTabla4">
    <div style="display: flex; justify-content: center;" class="cont-botones">
      <div class="select-linea">
        <!--------------------------------------Seleccionador tipo2--------------------------------------------->
        <div>
          <button class="seleccionador btn dropdown-toggle" type="button" data-bs-toggle="dropdown"
            aria-expanded="false">
            No. de línea {{ filaNumero }}
          </button>
          <ul class="dropdown-menu">
            <li *ngFor="let detalle of detalleOrdenPorConfirmar" (click)="seleccionarLinea(detalle.noLinea)" class="dropdown-item" href="#"> {{ detalle.noLinea }} </li>
          </ul>
        </div>
      </div>
    </div>

    <!-------------------------Tabla detalle entradas por línea-------------------------->
    <table class="table table-rounded table-hover orden entradas-linea">
      <thead>
        <tr>
          <th class="cabecera "  scope="col" style="width: 230px;">No. Línea</th>
          <th class="cabecera "  scope="col" style="width: 230px;">Descripción</th>
          <th class="cabecera end-text"  scope="col" style="width: 230px;">Cantidad</th>
          <th class="cabecera "  scope="col" style="width: 230px;">Unidad</th>
          <th class="cabecera end-text"  scope="col" style="width: 230px;">Precio</th>
          <th class="cabecera end-text"  scope="col" style="width: 230px;">Importe</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let orden of entradasLinea">
          <td *ngIf="orden.noLinea === filaNumero" class="none" style="width: 230px;"> {{ orden.noLinea }} </td>
          <td *ngIf="orden.noLinea === filaNumero" class="none" style="width: 230px;"> {{ orden.descripcion }} </td>
          <td *ngIf="orden.noLinea === filaNumero" class="none end-text" style="width: 230px;"> {{ orden.cantidad }} </td>
          <td *ngIf="orden.noLinea === filaNumero" class="none" style="width: 230px;"> {{ orden.unidadMedida }} </td>
          <td *ngIf="orden.noLinea === filaNumero" class="none end-text" style="width: 230px;">$ {{orden.precioUnitario}} </td>
          <td *ngIf="orden.noLinea === filaNumero" class="none end-text" style="width: 230px;"> $ {{orden.importe}} </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-------------------------------------------------- montos--------------------------------------------------->
  <div *ngIf="tablaMontos">
    <table class="table table-striped rounded table-hover">
      <thead>
        <tr>
          <th class="cabecera">Monto SUb. Total</th>
          <th class="cabecera">Monto Descuentos</th>
          <th class="cabecera">Imp. retenidos</th>
          <th class="cabecera">Imp. Traslados</th>
          <th class="cabecera">Total Orden Compra</th>
          <th class="cabecera">Moneda de operación</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="none">$16,500.00</td>
          <td class="none">$0</td>
          <td class="none">$0</td>
          <td class="none">$0</td>
          <td class="none">$16,500</td>
          <td class="none">USD</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!---------------------------------------------------Proveedor------------------------------------------------>
  <div *ngIf="pestanaProveedores">
    <table class="table table-striped rounded table-hover">
      <thead>
        <tr>
          <th class="cabecera">RFC</th>
          <th class="cabecera">Razón social</th>
          <th class="cabecera">Número de proveedor</th>
          <th class="cabecera">Días de credito</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="none">AAA010101AAA</td>
          <td class="none">Aceros del arbol</td>
          <td class="none">250045</td>
          <td class="none">15</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!---------------------------------------------------Comprador------------------------------------------------>
  <div *ngIf="pestanaComprador">
    <table class="table table-striped rounded table-hover">
      <thead>
        <tr>
          <th class="cabecera">Nombre Comprador</th>
          <th class="cabecera">Correo del comprador</th>
          <th class="cabecera">No. de requisición</th>
          <th class="cabecera">Tipo</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="none">Roberto Calderon</td>
          <td class="none"><p>rcalderon"&#64;"correo.com</p></td>
          <td class="none">146554</td>
          <td class="none">Material o servivio</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!---------------------------------------------------Entrega-------------------------------------------------->
  <div *ngIf="pestanaEntrega">
    <table class="table table-striped rounded table-hover">
      <thead>
        <tr>
          <th class="cabecera" style="width: 30%;">Dirección de entrega</th>
          <th class="cabecera">Fecha de entrega</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="none">Av. Pardos N0.345 col. centro. Ecatepec de Morelos, CDMX</td>
          <td class="none">23/11/2023</td>
        </tr>
      </tbody>
    </table>
  </div>


<!--Tabla detalle no.Entrada-->
  <div *ngIf="mostrarTabla5" class="contenedor">
    <div class="contenedor-detalle2">
        <div (click)="regresarOrdenes()" class="card-info-title-accion">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-return-left" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5z"/>
          </svg>
        </div>
        <div class="card-info-title">
          <table>
            <tbody>
              <tr style="display: flex; align-items: center;">
                <td class="info-card" > Detalle de la entrada: {{ ' ' + selectedNoEntrada.slice(0,-4) }}</td>
              </tr>
            </tbody>
          </table>
        </div>
    </div>
    <!-- tabla detalle de la entrada-->
    <table class="table table-striped rounded table-hover orden tabla-detalle">
      <thead>
        <tr>
          <th class="cabecera tabla377" scope="col">Línea</th>
          <th class="cabecera tabla377" scope="col">Descripción</th>
          <th class="cabecera tabla377" scope="col">Cantidad</th>
          <th class="cabecera tabla377" scope="col">Unidad de Medida</th>
          <th class="cabecera tabla377 end-text" scope="col">Precio unitario</th>
          <th class="cabecera tabla377 end-text" scope="col">Importe</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let orden of entradasLinea">
          <td *ngIf="orden.referencia === seleccionarDentradas" class="none" scope="col" style="width: 230px;"> {{ orden.noLinea }} </td>
          <td *ngIf="orden.referencia === seleccionarDentradas" class="none" scope="col" style="width: 230px;"> {{ orden.descripcion }} </td>
          <td *ngIf="orden.referencia === seleccionarDentradas" class="none" scope="col" style="width: 230px;"> {{ orden.cantidad }} </td>
          <td *ngIf="orden.referencia === seleccionarDentradas" class="none" scope="col"> {{ orden.unidadMedida }} </td>
          <td *ngIf="orden.referencia === seleccionarDentradas" class="none end-text" scope="col"> ${{ orden.precioUnitario }} </td>
          <td *ngIf="orden.referencia === seleccionarDentradas" class="none end-text end-text" scope="col"> ${{ orden.importe }} </td>
          <td style="display: none;" *ngIf="orden.referencia === seleccionarDentradas" class="none" scope="col"> ${{ orden.referencia }} </td>
        </tr>
      </tbody>
    </table>
  </div>
  <br>

  <!------------------------Icono inicio------------------------>

  <div class="icon-welcome" *ngIf="iconInfo" >
    <svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" fill="#b9dfe9" class="bi bi-bag-fill" viewBox="0 0 16 16" style="margin: 0 auto;">
      <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1m3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4z"/>
    </svg>
    <p style="margin-top: 10px; text-align: center; font-size: 16px;">Filtra tus Ordenes de Compras para poder verlas.</p>
  </div>





  <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Simulacion web service</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="input-group mb-3">
            <input type="file" class="form-control" id="inputGroupFile02" (change)="onFileChange($event)">
            <label class="input-group-text" for="inputGroupFile02">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-upload"
                viewBox="0 0 16 16">
                <path
                  d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"
                  style="margin-left: 10px;" />
                <path
                  d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z" />
              </svg>
            </label>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn button-primary" data-bs-dismiss="modal" (click)="onAceptarClick($event)">Aceptar</button>
        </div>
      </div>
    </div>
  </div>



<div class="modal fade" id="staticBackdrop1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel1">Cargar factura</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3">
          <label class="input-group-text">Número de proveedor</label>
          <input type="text" class="form-control" [(ngModel)]="selectedNumeroProveedor">
        </div>
        <div class="input-group mb-3">
          <input type="file" class="form-control" id="inputGroupFile02" multiple (change)="onFileChangeFactura($event)">
          <label class="input-group-text" for="inputGroupFile02">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-upload"
              viewBox="0 0 16 16">
              <path
                d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"
                style="margin-left: 10px;" />
              <path
                d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z" />
            </svg>
          </label>
        </div>
        <div class="input-group mb-3">
          <label class="input-group-text">Número de pedido</label>
          <input type="text" class="form-control" [(ngModel)]="selectedNoOrdenCompra">
        </div>
        <div class="input-group mb-3">
          <label class="input-group-text">Número de entrada</label>
          <input type="text" class="form-control" [(ngModel)]="selectedNoEntrada">
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn button-primary" data-bs-dismiss="modal" (click)="cargarFactura($event)">Aceptar</button>
      </div>
    </div>
  </div>
</div>










